!function(t){"use strict";var e=t.fn.bootstrapTable.utils.sprintf,o=function(e,o,r){if(o=t.trim(o),e=t(e.get(e.length-1)),i(e,o)){e.append(t("<option></option>").attr("value",o).text(t("<div />").html(r).text()));var n=e.find("option:gt(0)");n.sort(function(e,o){return e=t(e).text().toLowerCase(),o=t(o).text().toLowerCase(),t.isNumeric(e)&&t.isNumeric(o)&&(e=parseFloat(e),o=parseFloat(o)),e>o?1:o>e?-1:0}),e.find("option:gt(0)").remove(),e.append(n)}},i=function(t,e){for(var o=t.get(t.length-1).options,i=0;i<o.length;i++)if(o[i].value===e.toString())return!1;return!0},r=function(t){t.$tableHeader.css("height","77px")},n=function(t){var e=t.$header;return t.options.height&&(e=t.$tableHeader),e},a=function(t){var e="select, input";return t.options.height&&(e="table select, table input"),e},l=function(e){var o=n(e),i=a(e);e.options.valuesFilterControl=[],o.find(i).each(function(){e.options.valuesFilterControl.push({field:t(this).closest("[data-field]").data("field"),value:t(this).val()})})},s=function(e){var o=null,i=[],r=n(e),l=a(e);e.options.valuesFilterControl.length>0&&r.find(l).each(function(){o=t(this).closest("[data-field]").data("field"),i=t.grep(e.options.valuesFilterControl,function(t){return t.field===o}),i.length>0&&t(this).val(i[0].value)})},c=function(){var e=[],o=document.cookie.match(/(?:bs.table.)(\w*)/g);return o?(t.each(o,function(o,i){/./.test(i)&&(i=i.split(".").pop()),-1===t.inArray(i,e)&&e.push(i)}),e):void 0},f=function(e,i){var r,n,a=!1,l=0;t.each(e.columns,function(l,s){if(r="hidden",n=[],s.visible){if(s.filterControl){n.push('<div style="margin: 0 2px 2px 2px;" class="filterControl">');var c=s.filterControl.toLowerCase();s.searchable&&e.options.filterTemplate[c]&&(a=!0,r="visible",n.push(e.options.filterTemplate[c](e,s.field,r)))}else n.push('<div style="height: 34px;"></div>');if(t.each(i.children().children(),function(e,o){return o=t(o),o.data("field")===s.field?(o.find(".fht-cell").append(n.join("")),!1):void 0}),void 0!==s.filterData&&"column"!==s.filterData.toLowerCase()){var f=s.filterData.substring(0,3),u=s.filterData.substring(4,s.filterData.length),p=t("."+s.field);switch(o(p,"",""),f){case"url":t.ajax({url:u,dataType:"json",success:function(e){t.each(e,function(t,e){o(p,t,e)})}});break;case"var":var h=window[u];for(var d in h)o(p,d,h[d])}}}}),a?(i.off("keyup","input").on("keyup","input",function(t){clearTimeout(l),l=setTimeout(function(){e.onColumnSearch(t)},e.options.searchTimeOut)}),i.off("change","select").on("change","select",function(t){clearTimeout(l),l=setTimeout(function(){e.onColumnSearch(t)},e.options.searchTimeOut)}),i.off("mouseup","input").on("mouseup","input",function(o){var i=t(this),r=i.val();""!==r&&setTimeout(function(){var t=i.val();""===t&&(clearTimeout(l),l=setTimeout(function(){e.onColumnSearch(o)},e.options.searchTimeOut))},1)}),i.find(".date-filter-control").length>0&&t.each(e.columns,function(e,o){void 0!==o.filterControl&&"datepicker"===o.filterControl.toLowerCase()&&i.find(".date-filter-control."+o.field).datepicker(o.filterDatepickerOptions).on("changeDate",function(e){t(e.currentTarget).keyup()})})):i.find(".filterControl").hide()},u=function(t){switch(t=void 0===t?"left":t.toLowerCase()){case"left":return"ltr";case"right":return"rtl";case"auto":return"auto";default:return"ltr"}};t.extend(t.fn.bootstrapTable.defaults,{filterControl:!1,onColumnSearch:function(){return!1},filterShowClear:!1,alignmentSelectControlOptions:void 0,valuesFilterControl:[],filterTemplate:{input:function(t,o,i){return e('<input type="text" class="form-control %s" style="width: 100%; visibility: %s">',o,i)},select:function(t,o,i){return e('<select class="%s form-control" style="width: 100%; visibility: %s" dir="%s"></select>',o,i,u(t.options.alignmentSelectControlOptions))},datepicker:function(t,o,i){return e('<input type="text" class="date-filter-control %s form-control" style="width: 100%; visibility: %s">',o,i)}}}),t.extend(t.fn.bootstrapTable.COLUMN_DEFAULTS,{filterControl:void 0,filterData:void 0,filterDatepickerOptions:void 0,filterStrictSearch:!1}),t.extend(t.fn.bootstrapTable.Constructor.EVENTS,{"column-search.bs.table":"onColumnSearch"}),t.extend(t.fn.bootstrapTable.defaults.icons,{clear:"glyphicon-trash icon-clear"});var p=t.fn.bootstrapTable.Constructor,h=p.prototype.init,d=p.prototype.initToolbar,b=p.prototype.initHeader,m=p.prototype.initBody,v=p.prototype.initSearch;p.prototype.init=function(){if(this.options.filterControl){var t=this;this.options.valuesFilterControl=[],this.$el.on("reset-view.bs.table",function(){t.options.height&&(t.$tableHeader.find("select").length>0||t.$tableHeader.find("input").length>0||f(t,t.$tableHeader))}).on("post-header.bs.table",function(){s(t)}).on("post-body.bs.table",function(){t.options.height&&r(t)}).on("column-switch.bs.table",function(){s(t)})}h.apply(this,Array.prototype.slice.apply(arguments))},t.extend(t.fn.bootstrapTable.locales,{formatClearFilters:function(){return"Clear Filters"}}),t.extend(t.fn.bootstrapTable.defaults,t.fn.bootstrapTable.locales),p.prototype.initToolbar=function(){if(!this.showToolbar&&this.options.filterControl&&(this.showToolbar=this.options.filterControl),d.apply(this,Array.prototype.slice.apply(arguments)),this.options.filterControl&&this.options.filterShowClear){var o=this.$toolbar.find(">.btn-group"),i=o.find("div.export");i.length||(i=t(['<button class="btn btn-default" ',e('type="button" title="%s">',this.options.formatClearFilters()),e('<i class="%s %s"></i> ',this.options.iconsPrefix,this.options.icons.clear),"</button>","</ul>"].join("")).appendTo(o),i.off("click").on("click",t.proxy(this.clearFilterControl,this)))}},p.prototype.initHeader=function(){b.apply(this,Array.prototype.slice.apply(arguments)),this.options.filterControl&&f(this,this.$header)},p.prototype.initBody=function(){m.apply(this,Array.prototype.slice.apply(arguments));for(var e=this,i=this.options.data,r=this.pageTo<this.options.data.length?this.options.data.length:this.pageTo,n=this.pageFrom-1;r>n;n++){var a=i[n];t.each(this.header.fields,function(i,r){var l=a[r],s=e.columns[t.fn.bootstrapTable.utils.getFieldIndex(e.columns,r)];if(l=t.fn.bootstrapTable.utils.calculateObjectValue(e.header,e.header.formatters[i],[l,a,n],l),!(s.checkbox&&s.radio||void 0===s.filterControl||"select"!==s.filterControl.toLowerCase()||!s.searchable||void 0!==s.filterData&&"column"!==s.filterData.toLowerCase())){var c=t("."+s.field);void 0!==c&&c.length>0&&(0===c.get(c.length-1).options.length&&o(c,"",""),o(c,l,l))}})}},p.prototype.initSearch=function(){if(v.apply(this,Array.prototype.slice.apply(arguments)),"server"!==!this.options.sidePagination){var e=this,o=t.isEmptyObject(this.filterColumnsPartial)?null:this.filterColumnsPartial;this.data=o?t.grep(this.data,function(i,r){for(var n in o){var a=e.columns[t.fn.bootstrapTable.utils.getFieldIndex(e.columns,n)],l=o[n].toLowerCase(),s=i[n];if(a&&a.searchFormatter&&(s=t.fn.bootstrapTable.utils.calculateObjectValue(e.header,e.header.formatters[t.inArray(n,e.header.fields)],[s,i,r],s)),a.filterStrictSearch){if(-1===t.inArray(n,e.header.fields)||"string"!=typeof s&&"number"!=typeof s||s.toString().toLowerCase()!==l.toString().toLowerCase())return!1}else if(-1===t.inArray(n,e.header.fields)||"string"!=typeof s&&"number"!=typeof s||-1===(s+"").toLowerCase().indexOf(l))return!1}return!0}):this.data}},p.prototype.onColumnSearch=function(e){l(this);var o=t.trim(t(e.currentTarget).val()),i=t(e.currentTarget).closest("[data-field]").data("field");t.isEmptyObject(this.filterColumnsPartial)&&(this.filterColumnsPartial={}),o?this.filterColumnsPartial[i]=o:delete this.filterColumnsPartial[i],this.options.pageNumber=1,this.onSearch(e),this.updatePagination(),this.trigger("column-search",i,o)},p.prototype.clearFilterControl=function(){if(this.options.filterControl&&this.options.filterShowClear){var o=this,i=c(),r=n(o),l=r.closest("table"),f=r.find(a(o)),u=o.$toolbar.find(".search input"),p=0;if(t.each(o.options.valuesFilterControl,function(t,e){e.value=""}),s(o),f.length>0&&(this.filterColumnsPartial={},t(f[0]).trigger("INPUT"===f[0].tagName?"keyup":"change")),u.length>0&&o.resetSearch(),o.options.sortName!==l.data("sortName")||o.options.sortOrder!==l.data("sortOrder")){var h=e(r.find('[data-field="%s"]',t(f[0]).closest("table").data("sortName")));o.onSort(l.data("sortName"),l.data("sortName")),t(h).find(".sortable").trigger("click")}clearTimeout(p),p=setTimeout(function(){i&&i.length>0&&t.each(i,function(t,e){o.deleteCookie(e)})},o.options.searchTimeOut)}}}(jQuery);